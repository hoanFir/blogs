

http/2 相比于 http/1.1，大幅度提升了网页的性能。不过也存在兼容问题和如何优雅降级问题...

http/3 相比于 http/2，解决了后者存在的一些问题...


[原文](https://mp.weixin.qq.com/s/5jR7MrWQ9v3w_E8BhNWrpA)

## http/1.1

HTTP/1.1 自从 1997 年发布以来，随着互联网发展，从当初网页内容以文本为主, 到现在以富媒体（如图片、声音、视频）为主, 而且对页面内容实时性越来越高 （如聊天、视频直播），传输数据大小与平均请求资源数量不断持续增长, 于是当时协议规定的某些特性，已经无法满足现代网络的需求了。

### 1.1 网络延迟

随着互联网发展，网络带宽增长非常快，但网络延迟并没有对应程度的降低，网络延迟问题主要由于**队头阻塞 (Head-Of-Line Blocking)** 产生，导致带宽无法被充分利用。队头阻塞是指，当顺序发送的请求序列中的一个请求因为某种原因被阻塞时，在后面排队的所有请求也一并被阻塞，会导致接收端迟迟收不到数据。

一些方案：主要是针对请求资源数量多的情况

- 针对六浏览器对于同一个域名只允许 6 个 TCP 连接的限制，可以将资源分散到不同的域名下，从而提升连接上限

- 合并多张小图为一张大图, 再用 JavaScript 或者 CSS 将小图重新“切割”出来的技术，从而减小网络请求次数

- 小图片以base64格式直接嵌入文件中，从而避免请求很多小图片。如`.icon { background: url(data:image/png;base64,<data>) no-repeat; }`

- 打包技术，如webpack，也是为了减少网络请求次数

- ...


### 1.2 无状态

因为 http 协议是无状态的，所以一般一个请求会携带许多 headers 维护连接状态，如"User Agent"
"Cookie""Accept""Server"等许多固定的头字段，这些字段多达几百字节甚至上千字节，但 Body 却经常只有几十字节，因此这一定程度上增加了网络传输成本

### 1.3 明文传输

tips：https主要就是针对http明文传输问题和数据完整性问题

HTTP/1.1 在传输数据时，所有传输的内容都是明文，客户端和服务器端都无法验证对方的身份，这在一定程度上无法保证数据的安全性，因为攻击者可以直接截取你发送的请求中的数据，甚至泄漏了账户密码、银行卡号等敏感信息

### 1.4 不支持服务器向客户端推送信息

tips：websocket 协议是 HTML 5 引入的一种新协议，可实现客户端和服务器的全双工通信。和 http 协议都是应用层协议，都是基于 tcp，需要知道的是 websocket 在建立握手时数据是通过 http 传输的，在建立之后的真正传输过程不再需要 http







