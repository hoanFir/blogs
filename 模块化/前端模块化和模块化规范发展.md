ğŸ¾ å‰ç«¯æ¨¡å—åŒ–å’Œæ¨¡å—åŒ–è§„èŒƒå‘å±•

ğŸ•˜ 2019.10.30 ç”± hoanfirst ç¼–è¾‘

æ¨¡å—åŒ–ä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†å†…å®¹

1. æ¨¡å—åŒ–

2. æ¨¡å—åŒ–è§„èŒƒ

### ä¸€ã€ä»€ä¹ˆæ˜¯æ¨¡å—åŒ–ï¼Ÿ

å°†ä¸€ä¸ªå¤æ‚çš„ç¨‹åºä¾æ®ä¸€å®šè§„èŒƒå°è£…æˆå‡ ä¸ªæ–‡ä»¶ï¼Œå¹¶è¿›è¡Œç»„åˆåœ¨ä¸€èµ·ã€‚æ¨¡å—å†…éƒ¨çš„æ•°æ®/å®ç°æ˜¯ç§æœ‰çš„ï¼Œé€šè¿‡æš´éœ²ä¸€äº›æ¥å£ä¸å¤–éƒ¨å…¶ä»–æ¨¡å—è¿›è¡Œé€šä¿¡ã€‚

### äºŒã€æ¨¡å—åŒ–å‘å±•å†ç¨‹ï¼Ÿ

æœ€æ—©ï¼Œé€»è¾‘ä»£ç éƒ½æ˜¯æ”¾åœ¨ä¸€ä¸ªjsé‡Œé¢ï¼Œè¿™æ ·Globalå¯¹è±¡å®¹æ˜“è¢«æ±¡æŸ“ï¼Œå¾ˆå®¹æ˜“å‘½åå†²çªã€‚

```javascript


```
function foo() {}

function bar() {}

åæ¥ï¼Œå‡ºç°äº†ç®€å•çš„å‘½åç©ºé—´æ¨¡å¼ï¼Œå³namespaceã€‚è™½ç„¶å‡å°‘äº†Globalä¸Šçš„å˜é‡æ•°ç›®ï¼Œä½†æœ¬è´¨ä¸Šæ˜¯å¯¹è±¡ï¼Œå¯ä»¥è¢«æ”¹å˜ï¼Œä¸å®‰å…¨ã€‚
```javascript


```
var MYSPACE = {
  foo: function(),
  bar: function()
}
MYSPACE.foo();
æ¥ç€ï¼Œå‡ºç°äº†åŒ¿åé—­åŒ…ç«‹å³æ‰§è¡Œæ¨¡å¼ï¼Œå³IIFEã€‚å‡½æ•°æ˜¯jså”¯ä¸€çš„local scopeã€‚
```javascript


```
var Module = (function(){
  var _private = 'safe var',
  var foo = function(){ console.log(_private); }
  return {
    foo: foo
  }
})();

Module.foo();
Module._private; //undefined ä¸èƒ½æ“ä½œï¼Œç›¸å¯¹æ˜¯å®‰å…¨çš„
æœ€åï¼Œåœ¨åŒ¿åé—­åŒ…ç«‹å³æ‰§è¡Œæ¨¡å¼çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥ä¾èµ–ï¼Œè¿™å°±æ˜¯æ¨¡å—æ¨¡å¼ã€‚æ¨¡å—æ¨¡å¼æ˜¯ç°ä»£æ¨¡å—å®ç°çš„åŸºçŸ³ã€‚
```javascript


```
//é€šè¿‡å½¢å‚çš„å½¢å¼å¼•å…¥(æ³¨å…¥)ä¾èµ–
(function(window, $){
  var _private = 'safe var',
  var foo = function(){ console.log(_private); }
  window.module = { foo };
  $('body').css('background', 'red');
})(window, jQuery);

module.foo(); 

### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¨¡å—åŒ–ï¼Ÿ

webåº”ç”¨è¶Šæ¥è¶Šå¤æ‚

è§£è€¦æ€§éœ€æ±‚è¶Šæ¥è¶Šé«˜

deployment(éƒ¨ç½²) wants optimized code in few HTTP calls

æ€»è€Œè¨€ä¹‹ï¼Œå¼•å…¥æ¨¡å—åŒ–æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š

é¿å…å‘½åå†²çªï¼Œå‡å°‘å‘½åç©ºé—´æ±¡æŸ“

æ”¯æŒæŒ‰éœ€åŠ è½½

å¤ç”¨æ€§æ›´é«˜

å¯ç»´æŠ¤æ€§æ›´é«˜

### é¡µé¢å¼•å…¥æ¨¡å—å‡ºç°çš„é—®é¢˜ï¼Ÿ

æ¨¡å—è¿‡å¤šé€ æˆé¡µé¢è¯·æ±‚jsè¿‡å¤š

ä¾èµ–æ¨¡ç³Šï¼Œæ¨¡å—å¼•å…¥é¡ºåºä¸å¯æ›´æ”¹

éš¾ä»¥ç»´æŠ¤

### æ¨¡å—åŒ–è§„èŒƒ

CommonJS

AMD

ES6

CommonJS

åœ¨æœåŠ¡å™¨ç«¯æ¨¡å—åŠ è½½æ˜¯è¿è¡Œæ—¶åŒæ­¥åŠ è½½çš„ï¼Œè¿™ç§åŒæ­¥æœºåˆ¶åœ¨æµè§ˆå™¨ç«¯ç”¨æˆ·ä½“éªŒæ˜¯å¾ˆä¸å‹å¥½çš„ï¼Œå› æ­¤åœ¨æµè§ˆå™¨ç«¯æ¨¡å—ä¸€èˆ¬éœ€è¦æå‰ç¼–è¯‘æ‰“åŒ…(Browserify)å¤„ç†ã€‚
```javascript


```
//æš´éœ²
module.exports = value;
exports.xxx = value;
```javascript


```
//å¼•å…¥
require(xxx)
CommonJSæ¨¡å—åŒ–è§„èŒƒåœ¨æœåŠ¡å™¨ç«¯å®ç°ä¸»è¦æœ‰NodeJSï¼Œåœ¨æµè§ˆå™¨ç«¯ä¸»è¦æ˜¯é€šè¿‡Browserifyå®ç°ï¼Œä¹Ÿç§°ä¸ºCommonJSçš„æµè§ˆå™¨ç«¯çš„æ‰“åŒ…å·¥å…·ã€‚

AMD
AMDï¼ŒAsynchronous Module Definitionæ¨¡å—åŒ–è§„èŒƒä¸“é—¨ç”¨äºæµè§ˆå™¨ç«¯ï¼Œæ¨¡å—çš„åŠ è½½æ˜¯å¼‚æ­¥çš„ã€‚
```javascript


```
//æš´éœ²æ¨¡å—
define(function(){
  return ...
})
define(['module1', 'module2'], function(m1, m2) {
  return ...
})
```javascript


```
//å¼•å…¥æ¨¡å—
require([''module1, 'module2'], function(m1, m2) {
  ...
})
AMDå®ç°ç”¨RequireJS(a js file and module loader)ã€‚
```javascript


```
//app.js
(function() {
  requirejs.config({
    baseUrl: 'js/', //åŸºæœ¬è·¯å¾„ å‡ºå‘ç‚¹åœ¨æ ¹ç›®å½•ä¸‹
    paths: { //é…ç½®æ¨¡å—è·¯å¾„
        app: './app',
        other: './modules/other',
        jquery: './lib/jquery-1.10.1'
    }
  })
  requirejs(['jquery', 'canvas', 'app/sub'], function($, canvas, sub){
    //loaded and can be used here now.
  }) 
})();
ES6
ES6å¼•å…¥çš„æ¨¡å—åŒ–è§„èŒƒã€‚

ä¾èµ–æ¨¡å—åŒCommonJSåœ¨æµè§ˆå™¨ç«¯ä¸€æ ·éœ€è¦ç¼–è¯‘æ‰“åŒ…å¤„ç†ã€‚

å› ä¸ºES6åœ¨ä¸€äº›æµè§ˆå™¨è¿˜ä¸æ”¯æŒï¼Œéœ€è¦ä½¿ç”¨babelè½¬åŒ–æˆES5ï¼Œæ³¨æ„ES5çš„exportå’Œrequireè¿˜éœ€è¦ç”¨ä¸Šé¢æåˆ°çš„Browserifyæ¥æ”¯æŒã€‚

1. å®‰è£…ï¼š
```javascript


```
npm i babel-cli -g //cli: command line interface. babel-cliæ”¯æŒç›´æ¥ä½¿ç”¨babelçš„å‘½ä»¤
npm i browserify -g
npm i babel-preset-es2015 --save-dev //å°†es6è½¬åŒ–æˆes5çš„å·¥å…·éƒ½ä¸‹è½½å¥½

```javascript


```
2. babelrc and Browserifyï¼š

//rc: run control
{
  'presets': ['es2015', 'react']
}

//run
babel js/src -d js/lib
browserify js/lib/app.js -o js/lib/bundle.js

3. è¯­æ³•

```javascript


```
//åˆ†åˆ«æš´éœ²(å¸¸è§„æš´éœ²)
export function foo() {}
export function bar() {} 
export let arr = []
 
//ç»Ÿä¸€æš´éœ²(å¸¸è§„æš´éœ²)
function fun1() {}
function fun2() {} 
export { fun1, fun2 };

//å¼•å…¥å¸¸è§„æš´éœ²éœ€è¦ä½¿ç”¨è§£æ„èµ‹å€¼
import { foo, bar } from './module1';
import { fun1, fun2 } from './module2'; 

//(é»˜è®¤æš´éœ²)
export default fun;

//å¼•å…¥é»˜è®¤æš´éœ²
import xxx from './module2'
