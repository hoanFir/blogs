🐾 使用js正则检查参考文献格式

🕘 2020.01.07 由 hoanfirst 编辑

本文正则设计基于《学术期刊电子稿件参考文献自动校验的XML解决方案/张春玲》。

### 一、场景

在《学术期刊电子稿件参考文献自动校验的XML解决方案》中是先将word文档先转换为半结构化的WordML文档，WordML具有XML文档的结构但非常复杂，接着通过XSLT样式表文件判断参考文献标注方式并依据判断结果从WordML文档的不同位置提取参考文献信息，整合生成独立的“参考文献.xml“文件，最后进入参考文献校验流程，基于正则表达式来校验。

而对于我们的需求，能获取到参考文献的text内容，因此可以直接进入“参考文献校验流程”。

### 二、参考文献的校验逻辑设计与分析

语义化的本质是，以计算机应用程序可以理解的方式描述事物。

首先，根据《文后参考文献著录规则》（GB/T7714--2005），使用正则表达式将其改写为计算机可读的结构化语法规则，再将其用于匹配“参考文献文本内容”。

#### 1. 参考文献标注的校验逻辑

我们的需求并不要求对整篇文章里的“参考文献标注”部分进行检测，因此该部分可忽略。

#### 2. 参考文献著录格式的校验逻辑

重点。

著录格式匹配逻辑如下图：

![](https://github.com/hoanFir/blogs/blob/master/RegExp/images/%E6%88%AA%E5%B1%8F2020-01-07%E4%B8%8B%E5%8D%884.55.13.png?raw=true)


##### 2.1 提取一条参考文献

我们从word复制出来的文献txt内容如下：

```

示例1:

[1]王璐.物流快递信息系统设计与实现[D].湖南大学,2016.
[2]曹钟.结合Hadoop大数据处理框架的智能快递信息系统设计与实现[D].北京建筑大学,2016.
[3]孙书盛.中国农村快递物流信息系统分析及推广建议[J].企业技术开发,2016,35(05):70-71.
[4]张哲瑞.快递物流管理系统的设计与开发[D].燕山大学,2015.
[5]蔡文学,宋尚江,王恒鹏,安李璐.面向物流快递企业的智能信息采集和包裹查询服务信息系统设计[J].物流技术,2009,28(12):219-221.
[6]王东.基于DotNetNuke的中小型物流快递系统的设计与实现[D].东北大学,2009.


示例2:

[1]参考文献管理软件的比较分析[J]. 邹小筑,李宏芳.  情报杂志. 2010(S1)
[2]学术期刊参考文献规范化问题探讨——以图书情报专业核心期刊为例[J]. 杨丽.  图书馆论坛. 2010(01)

```


##### 2.2 提取参考文献类型标志

tips：参考文献遵循的著录格式不只有一个，根据不同的出版方式，有不同的著录格式定义。

（1）分析：

一条参考文献应该遵照哪一种著录格式，需要判断参考文献类型。每一种参考文献类型标志都只对应一种出版物类型，即只对应一种著录格式。

具体如下：

1. 连续出版物

期刊\[J\]
报纸\[N\]

2. 连续出版物中对析出文献

期刊中对文章\[J\]
报纸中对文章\[N\]

3. 专利文献

专利\[P\]

4. 电子文献

计算机程序\[CP\]
电子公告\[EB\]
数据库\[DB\]

5. 专著

标准\[S\]
报告\[R\]
汇编\[G\]
会议录\[C\]

6. 专著中对析出文献

汇编中对文章\[G\]
会议录中对论文\[C\]
学位论文\[D\]
普通图书\[M\]


（2）正则设计：

因为所有参考文献类型标志，都有一个`.`紧随其后，因此可以设计如下正则：

```

\b (\b (\[ (:Lu{1,2}|:Lu{2}) \]) \.\b) ?\b

匹配如：

[X].
[X/ZY].
[XW/ZY].

```

通过上述正则即可匹配到类型标志字符串。

将该字符串与给定对文献类型标识正则表达式`([JMDRSPGN]/[(DB)(CP)(EB))I (([JMDRSPGN] [(DB)(CP)(EB)])V[(MT)(DK)(DB)(OL)])`进行匹配，若结果为true，则说明输入的参考类型标志字符串是正确的，若结果为false，则return并告知用户。



##### 2.3 调用不同类型相应对正则表达式进行匹配

关键：根据《文后参考文献著录规则》（GB/T7714--2005），为每一种文献类型，编写相应的正则表达式作为匹配标准。

然后对每一条参考文献进行匹配，若结果为true，则格式正确，若结果为false，则return并告知用户。



##### 2.4 分割参考文献，判断著录项（可选优化）




#### 3. 参考文献出处链接的校验逻辑

我们的需求并不要求对“参考文献a标签链接”部分进行检测，因此该部分可忽略。


### 三、JavaScript代码实现

1. 根据换行符抽出多个参考文献构造一个数组
2. 遍历数组对每个参考文献进行处理
3. 去掉空格
4. 提取“参考类型类型标志”进行匹配，判断是否有类型标志、是否为正确的文献类型标志
