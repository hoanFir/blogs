🐾 排序算法

🕘 2019.10.20 由 hoanfirst 编辑

> 原文 《吴军的谷歌方法论》 – 从计算机的算法，谈谈提高效率的本质

本质：少做事情。

计算机最早的排序算法源于人的生活和经验，这就如何最早的计算机下棋是模仿人，最早设计的飞行器是模仿鸟一样。

### 一、人类是如何排序的

- 如果只有三五个数字，肉眼扫描就可以排序好

- 如果是几十个数字，就需要严格遵守一个流程，否则容易出现小错误

对于几十个数字以上的排序，早期的科学家提出的排序算法有如下两种，比较笨但不会出错的方法：

- **冒泡排序**。

关键：每一次从未排序好的序列里找出最好的

场景：比如，给50个人的成绩从小到大排序，从0到49遍历50次，每一次循环中都要对未排序好的序列所有值两两比较，第一次循环比较50次挑出成绩最高的同学，放在序列最后，未排序好的序列剩前面49人，第二次循环从49人中比较49次挑出成绩次高的，放在成绩最高的前面...如此重复。

算法复杂度：O(n平方)

- **插入排序**。每一次从已排序好的序列里找到合适的位置插入

比如,给50个人的成绩从小到大排序，先把成绩单第1个位置的同学的成绩写到旁边另一张纸的中央，再在成绩单上找第2个位置的同学的成绩，如果第2个位置的同学成绩更高，将其写到到另一张纸上第1个位置的同学的上方，否则写在下方。继续将第3个位置的同学的成绩跟前面两个同学的成绩比较，插入到相应的位置...如此重复。当然，白纸要留够空白。

算法复杂度：O(n平方)

- 其他

复杂度和冒泡、插入都差不多，在一个量级。


### 二、计算机一开始使用的排序方法

计算机一开始的排序算法也主要是上述冒泡排序和插入排序。根据高德纳思想分析算法复杂度发现基本都在同一个量级。


### 三、那么如何提高计算机算法的效率

**从计算量出发。**

节省 20% 的计算量是没有意义的事情，就算省个三五倍也没有意义，要省就省成千上万倍甚至更多。

于是，全世界的算法专家经过十多年，终于发现从经验出发的排序算法速度慢的原因是做了无数的无用功。**要提高效率，就是需要让计算机少做事情**。

#### 3.1 改进冒泡排序：归并排序

先以冒泡排序为例，它每一次选出一个最大的数都要和其他所有数字相比较，这样就做了很多无用功。

最早对冒泡排序的改进是使用归并排序。

比如，同样是排序全班同学的成绩，但根据归并排序的归并思想：

首先将同学们分成两组，分别排序，再把排好序的两组合并成一个有序的序列（相比排序，**对有序序列合并是很快的**，归并排序这个词关键于此），这样做就能大约省去1/2的比较时间。既然可以分成两组，就能把这两个组各自再分成两组，这样做就可以省去3/4的比较时间，以此类推，四组分成八组，省去7/8时间，八组分为十六组，省去15/16时间...直到分到最后每个小组只剩下两个同学，其实就不用排序了，主要比较一次大小即可。

归并排序，其实可以理解为两个过程，**先自顶向下分组，再自底向上合并**。

算法复杂度分析：

O(nlogn)，这个复杂度比n^2要小很多。比如，当n是100,10000,1000000，它对应的nlogn是700,13万,2000万.而对应的n^2是一万，一亿，一万亿。

归并排序算法为什么效率提高这么多？因为它少做了很多并不需要做的比较。**效率=产出/所做的事情。人的产能可能有限，但所做的事是可以减少的。**

**另外，归并排序还说明了一个道理，将一个复杂问题分解成很多个简单的问题，一个个解决，最后比直接解决复杂问题要省很多时间。**

#### 3.2 快速排序

一个算法的好坏要分场景，**理想情况下**最好，还是**一般情况下**最好，又或者**恶劣情况下**最好。

目前时间上一般情况下最好的算法是快速排序算法。

快速排序算法是由英文计算机科学家Tony Hoare于1961年发表的。目前这个算法已经成为世界计算机产业中用到的最多的排序算法。

快速排序的原理：

首先，对于一大堆无序的数字，从中随机挑选一个，比如是53，这个被随机选上的数字被称为枢值（枢纽的枢），接下来，将所有数字分成两部分，第一部分是大于等于枢值53的，第二部分是小于枢值53的，这样一大堆无序的数字就变得稍微有序一点了。第二步，从上面得到的两堆数字，分别采用第一步的方法各自再找一个枢值。对于第一堆，由于所有的数字都比53大，至少也等于53，因此，第二次随机挑选的枢值肯定是一个大于53的数字，比如79；类似地，对于第二堆，由于所有的数字都小于53，因此第二次随机挑选的枢值肯定小于它，比如4。接下来，再把两堆数字各自分成大于等于相应枢值的数字序列，以及小于枢值的数字序列。这样做下来，原来的一大堆数就变成了四小堆，它们分别是小于4的数字，介于4到53之间的，介于53到79之间的，以及大于或等于79的。第三步就是，用同样的方法，四堆变八堆，八堆变十六堆，很快所有的数字就能排好序了。

快速排序的算法复杂度是 nlogn，和归并排序相同。

但是，虽然根据计算机科学的标准，它们同样好，不过**在工程上，快速排序算法在一般情况下比归并排序快两倍**，因此在工程上还是有意义的。

Q：为什么快速排序能更快一些呢？

A：这可以在计算机科学上证明，不过为了方便理解，我打一个比方你就明白了。假如有2000名高中生，要从中挑出尖子，如果是归并排序，就相当于把2000人放到10所学校，每所学校只有200人，再从这10所中挑出尖子，最后再相互排序选出的尖子；如果是快速排序，就相当于先划分数线，根据成绩高低把排前200放到一个学校，200\~400放到一个学校，最后1800\~2000放到一个学校，即第十所最差，再分别找出学习尖子，最后直接合并选出的尖子，这样工作量最小。

### 四、总结

算法没有学好的人，写出来的程序经常是不合格的，因为很容易就浪费掉成千上万倍的计算机资源。吴军一直强调工程师水平差一级，贡献可能就差出10倍，而到了智能时代，本事差一点，效果可能差几万倍，几亿倍。

- 冒泡是每个人都要公平和和所有人比；
- 归并排序是递归分组后再比；
- 快速排序是根据枢值分组后再比。

所以说，绝对的公平导致效率更低。
